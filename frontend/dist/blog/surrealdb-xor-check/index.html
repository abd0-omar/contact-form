<!DOCTYPE html><html lang="en" data-theme="nord-dark"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="apple-touch-icon" sizes="180x180" href="/favicon_io/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon_io/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon_io/favicon-16x16.png"><link rel="manifest" href="/favicon_io/site.webmanifest"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Abdo" href="https://example.com/rss.xml"><meta name="generator" content="Astro v5.9.1"><!-- Font preloads --><link rel="preload" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" as="style"><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><!-- Canonical URL --><link rel="canonical" href="https://example.com/blog/surrealdb-xor-check/"><!-- Primary Meta Tags --><title>Enforcing XOR (Either/Or) Fields in SurrealDB</title><meta name="title" content="Enforcing XOR (Either/Or) Fields in SurrealDB"><meta name="description" content="Learn how to enforce mutually exclusive fields (XOR) in SurrealDB, ensuring a record has either one field or another, but not both or neither"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://example.com/blog/surrealdb-xor-check/"><meta property="og:title" content="Enforcing XOR (Either/Or) Fields in SurrealDB"><meta property="og:description" content="Learn how to enforce mutually exclusive fields (XOR) in SurrealDB, ensuring a record has either one field or another, but not both or neither"><meta property="og:image" content="https://example.com/_astro/blog-placeholder-1.Bx0Zcyzv.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://example.com/blog/surrealdb-xor-check/"><meta property="twitter:title" content="Enforcing XOR (Either/Or) Fields in SurrealDB"><meta property="twitter:description" content="Learn how to enforce mutually exclusive fields (XOR) in SurrealDB, ensuring a record has either one field or another, but not both or neither"><meta property="twitter:image" content="https://example.com/_astro/blog-placeholder-1.Bx0Zcyzv.jpg"><link rel="stylesheet" href="/_astro/about.LDaueO-U.css">
<style>html{scroll-behavior:smooth}.prose h2,.prose h3,.prose h4,.prose h5,.prose h6{scroll-margin-top:6rem}.article-nav[data-astro-cid-xvrfupwn]>div[data-astro-cid-xvrfupwn]{backdrop-filter:blur(12px);background-color:hsl(var(--b2) / .98);box-shadow:0 8px 32px hsl(var(--bc) / .08)}@media (max-width: 1024px){.article-nav[data-astro-cid-xvrfupwn]{display:none}}.article-nav[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]{transition:all .25s cubic-bezier(.4,0,.2,1);position:relative}.article-nav[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]:before{content:"";position:absolute;left:0;top:0;bottom:0;width:2px;background:transparent;transition:all .25s cubic-bezier(.4,0,.2,1)}.article-nav[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]:hover{transform:translate(3px);color:hsl(var(--p))}.article-nav[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]:hover:before{background:hsl(var(--p) / .3)}
</style></head> <body class="bg-base-100 text-base-content"> <header class="navbar bg-base-100 shadow-lg sticky top-0 z-50"> <div class="navbar-start"> <h2 class="font-bold" style="font-size: 18px;"> <a href="/" class="btn btn-ghost normal-case text-primary hover:text-primary-focus" style="font-size: 18px;"> Abdo </a> </h2> </div> <div class="navbar-center hidden lg:flex"> <ul class="menu menu-horizontal px-1" style="font-size: 18px;"> <li><a href="/" class="btn btn-ghost px-4" style="font-size: 18px !important;"> Home </a></li> <li><a href="/blog" class="btn btn-ghost px-4 btn-active text-primary" style="font-size: 18px !important;"> Blog </a></li> <li><a href="/about" class="btn btn-ghost px-4" style="font-size: 18px !important;"> About </a></li> <!-- {
				!isLoggedIn && ( --> <!-- <li>
				<HeaderLink href="/subscriptions">Subscribe</HeaderLink>
			</li> --> <!-- )
			}
			{
				isLoggedIn && ( --> <!-- <>
						<li>
							<HeaderLink href="/dashboard">Dashboard</HeaderLink>
						</li>
						<li>
							<HeaderLink href="/admin/newsletters">
								Publish
							</HeaderLink>
						</li>
					</> --> <!-- )
			} --> </ul> </div> <div class="navbar-end"> <!-- Mobile menu dropdown --> <div class="dropdown dropdown-end lg:hidden"> <label tabindex="0" class="btn btn-ghost btn-circle"> <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> </label> <ul tabindex="0" class="dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52" style="font-size: 18px;"> <li><a href="/" class="btn btn-ghost px-4" style="font-size: 18px !important;"> Home </a></li> <li><a href="/blog" class="btn btn-ghost px-4 btn-active text-primary" style="font-size: 18px !important;"> Blog </a></li> <li><a href="/about" class="btn btn-ghost px-4" style="font-size: 18px !important;"> About </a></li> <!-- {
					!isLoggedIn && ( --> <li> <a href="/subscriptions" class="btn btn-ghost px-4" style="font-size: 18px !important;">  Subscribe  </a> </li> <!-- )
				}
				{
					isLoggedIn && (
						<>
							<li>
								<HeaderLink href="/dashboard">
									Dashboard
								</HeaderLink>
							</li>
							<li>
								<HeaderLink href="/admin/newsletters">
									Publish
								</HeaderLink>
							</li>
						</>
					)
				} --> </ul> </div> <!-- Auth buttons --> <!-- <div class="hidden sm:flex gap-2"> --> <!-- {
				!isLoggedIn ? ( --> <a href="/login" class="btn btn-primary btn-sm"> Login </a> <!-- ) : (
					<form action="/admin/logout" method="post" class="m-0">
						<button type="submit" class="btn btn-ghost btn-sm">
							Logout
						</button>
					</form>
				)
			} --> <!-- </div> --> <!-- Social links - hidden on mobile --> <div class="hidden sm:flex gap-2 ml-2"> <a href="https://github.com/abd0-omar" target="_blank" class="btn btn-ghost btn-circle btn-sm" aria-label="Go to abdo's GitHub repo" style="font-size: 18px;"> <svg class="w-[18px] h-[18px] fill-current" viewBox="0 0 16 16" aria-hidden="true"> <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path> </svg> </a> </div> <div class="hidden sm:flex gap-2 ml-2"> <a href="https://www.linkedin.com/in/abdelrahman-omar-739126248/" target="_blank" class="btn btn-ghost btn-circle btn-sm" aria-label="Go to Abdelrahman's LinkedIn profile" style="font-size: 18px;"> <svg class="w-[24px] h-[24px] fill-current" viewBox="0 0 24 24" aria-hidden="true"> <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path> </svg> </a> </div> <div class="hidden sm:flex gap-2 ml-2"> <a href="mailto:abdelrahman.omar.elgendy@gmail.com" class="btn btn-ghost btn-circle btn-sm" aria-label="Send email to Abdelrahman" style="font-size: 18px;"> <svg class="w-[24px] h-[24px] fill-current" viewBox="0 0 24 24" aria-hidden="true"> <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path> </svg> </a> </div> </div> </header> <nav class="article-nav fixed right-2 top-1/2 transform -translate-y-1/2 block w-40 z-50" aria-label="Table of Contents" data-astro-cid-xvrfupwn><div class="bg-base-200 rounded-box border border-base-300 shadow-xl p-2 backdrop-blur-sm" data-astro-cid-xvrfupwn><ul class="space-y-1 text-xs" data-astro-cid-xvrfupwn><li class="pl-0" data-astro-cid-xvrfupwn><a href="#arc-relationship" class="toc-link group block py-1 px-1.5 rounded transition-all duration-200 ease-out
                                       text-base-content/70 hover:text-primary hover:bg-base-300/30
                                       border-l-2 border-transparent hover:border-primary/40
                                       text-xs leading-tight relative overflow-hidden" data-astro-cid-xvrfupwn>Arc Relationship</a></li><li class="pl-0" data-astro-cid-xvrfupwn><a href="#surrealdb" class="toc-link group block py-1 px-1.5 rounded transition-all duration-200 ease-out
                                       text-base-content/70 hover:text-primary hover:bg-base-300/30
                                       border-l-2 border-transparent hover:border-primary/40
                                       text-xs leading-tight relative overflow-hidden" data-astro-cid-xvrfupwn>SurrealDB</a></li><li class="pl-1" data-astro-cid-xvrfupwn><a href="#the-complete-schema" class="toc-link group block py-1 px-1.5 rounded transition-all duration-200 ease-out
                                       text-base-content/70 hover:text-primary hover:bg-base-300/30
                                       border-l-2 border-transparent hover:border-primary/40
                                       text-xs leading-tight relative overflow-hidden" data-astro-cid-xvrfupwn>The Complete Schema</a></li><li class="pl-1" data-astro-cid-xvrfupwn><a href="#defining-the-schema" class="toc-link group block py-1 px-1.5 rounded transition-all duration-200 ease-out
                                       text-base-content/70 hover:text-primary hover:bg-base-300/30
                                       border-l-2 border-transparent hover:border-primary/40
                                       text-xs leading-tight relative overflow-hidden" data-astro-cid-xvrfupwn>Defining the schema</a></li><li class="pl-1" data-astro-cid-xvrfupwn><a href="#defining-the-xor-check" class="toc-link group block py-1 px-1.5 rounded transition-all duration-200 ease-out
                                       text-base-content/70 hover:text-primary hover:bg-base-300/30
                                       border-l-2 border-transparent hover:border-primary/40
                                       text-xs leading-tight relative overflow-hidden" data-astro-cid-xvrfupwn>Defining the XOR check</a></li><li class="pl-1" data-astro-cid-xvrfupwn><a href="#testing" class="toc-link group block py-1 px-1.5 rounded transition-all duration-200 ease-out
                                       text-base-content/70 hover:text-primary hover:bg-base-300/30
                                       border-l-2 border-transparent hover:border-primary/40
                                       text-xs leading-tight relative overflow-hidden" data-astro-cid-xvrfupwn>Testing</a></li><li class="pl-0" data-astro-cid-xvrfupwn><a href="#surrealdb-cleaner-solution" class="toc-link group block py-1 px-1.5 rounded transition-all duration-200 ease-out
                                       text-base-content/70 hover:text-primary hover:bg-base-300/30
                                       border-l-2 border-transparent hover:border-primary/40
                                       text-xs leading-tight relative overflow-hidden" data-astro-cid-xvrfupwn>SurrealDB Cleaner Solution</a></li><li class="pl-0" data-astro-cid-xvrfupwn><a href="#sql" class="toc-link group block py-1 px-1.5 rounded transition-all duration-200 ease-out
                                       text-base-content/70 hover:text-primary hover:bg-base-300/30
                                       border-l-2 border-transparent hover:border-primary/40
                                       text-xs leading-tight relative overflow-hidden" data-astro-cid-xvrfupwn>SQL</a></li></ul></div></nav> <main class="container mx-auto max-w-4xl px-4 py-8"> <article class="card bg-base-100 shadow-lg"> <!-- Hero Image Section --> <figure class="card-image"> <img src="/_astro/horizontal_dinosaur.CeEMID10_bwDsS.webp" alt width="1020" height="510" loading="lazy" decoding="async" class="w-full h-64 md:h-80 object-cover rounded-t-box"> </figure> <!-- Content Section --> <div class="card-body"> <!-- Title and Meta Section --> <div class="text-center mb-8"> <!-- Date Badge --> <div class="flex flex-col sm:flex-row items-center justify-center gap-2 mb-4"> <div class="badge badge-primary badge-lg"> <time datetime="2025-08-16T21:00:00.000Z"> Aug 17, 2025 </time> </div>  </div> <!-- Title --> <h1 class="card-title text-3xl md:text-4xl lg:text-5xl text-primary mb-4 justify-center"> Enforcing XOR (Either/Or) Fields in SurrealDB </h1> <!-- Divider --> <div class="divider divider-primary"></div> </div> <!-- Blog Content --> <div class="prose prose-lg max-w-none">  <h1 id="how-to-enforce-xor-eitheror-fields-in-surrealdb">How to enforce XOR (Either/Or) Fields in SurrealDB</h1>
<p>When designing a database schema, you could encounter situations where a record
should contain one of two possible fields, but not both or neither. For example, a
<code>repository</code> might be owned by either a <code>user</code> or an <code>organization</code>, but never
both simultaneously or neither. This is known as an XOR or “either/or” constraint.</p>
<p><img alt="xor boxes" width="621" height="421" loading="lazy" decoding="async" src="/_astro/box-svg.Cv_ihi0u_1SLl1k.svg" ></p>
<h2 id="arc-relationship">Arc Relationship</h2>
<p>This scenario is also known as an Arc Relationship in Entity Relationship modeling.
In ER Diagram, it is shown by drawing an arc across the relationship lines,
hence the name arc relationship.</p>
<p><img alt="arc diagram" width="660" height="300" loading="lazy" decoding="async" src="/_astro/arc-svg-final.CrKlsNao_1rjdlG.svg" ></p>
<h2 id="surrealdb">SurrealDB</h2>
<h3 id="the-complete-schema">The Complete Schema</h3>
<p>Here is the complete schema definition for our <code>repository</code> table to showcase how
to enforce the XOR constraint.</p>
<h3 id="defining-the-schema">Defining the schema</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#E1E4E8">DEFINE </span><span style="color:#F97583">TABLE</span><span style="color:#E1E4E8"> repository SCHEMAFULL;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">DEFINE FIELD </span><span style="color:#F97583">name</span><span style="color:#F97583"> ON</span><span style="color:#E1E4E8"> repository </span><span style="color:#F97583">TYPE</span><span style="color:#E1E4E8"> string;</span></span>
<span class="line"><span style="color:#6A737D">-- Use `option&#x3C;>` to allow fields to be omitted before the XOR check</span></span>
<span class="line"><span style="color:#E1E4E8">DEFINE FIELD user </span><span style="color:#F97583">ON</span><span style="color:#E1E4E8"> repository </span><span style="color:#F97583">TYPE</span><span style="color:#F97583"> option&#x3C;</span><span style="color:#E1E4E8">record</span><span style="color:#F97583">&#x3C;</span><span style="color:#E1E4E8">user</span><span style="color:#F97583">>></span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">DEFINE FIELD organization </span><span style="color:#F97583">ON</span><span style="color:#E1E4E8"> repository </span><span style="color:#F97583">TYPE</span><span style="color:#F97583"> option&#x3C;</span><span style="color:#E1E4E8">record</span><span style="color:#F97583">&#x3C;</span><span style="color:#E1E4E8">organization</span><span style="color:#F97583">>></span><span style="color:#E1E4E8">;</span></span></code></pre>
<h3 id="defining-the-xor-check">Defining the XOR check</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#6A737D">-- Fields in surrealdb are represented as a key-value pair</span></span>
<span class="line"><span style="color:#6A737D">-- `VALUE` is used to get the raw "value" of the field and omitting the "key"</span></span>
<span class="line"><span style="color:#E1E4E8">DEFINE FIELD owner_type </span><span style="color:#F97583">ON</span><span style="color:#E1E4E8"> repository </span><span style="color:#F97583">VALUE</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">    -- 1. Check if NEITHER is set</span></span>
<span class="line"><span style="color:#F97583">    IF</span><span style="color:#E1E4E8"> user </span><span style="color:#F97583">=</span><span style="color:#F97583"> NONE</span><span style="color:#F97583"> AND</span><span style="color:#E1E4E8"> organization </span><span style="color:#F97583">=</span><span style="color:#F97583"> NONE</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">        THROW</span><span style="color:#9ECBFF"> "a repository requires either a user or an organization owner"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#6A737D">    -- 2. Check if BOTH are set</span></span>
<span class="line"><span style="color:#F97583">    ELSE</span><span style="color:#F97583"> IF</span><span style="color:#E1E4E8"> user </span><span style="color:#F97583">!=</span><span style="color:#F97583"> NONE</span><span style="color:#F97583"> AND</span><span style="color:#E1E4E8"> organization </span><span style="color:#F97583">!=</span><span style="color:#F97583"> NONE</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">        THROW</span><span style="color:#9ECBFF"> "a repository cannot have both a user and an organization owner"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    -- 3. (Optional) If validation passes, return the owner type</span></span>
<span class="line"><span style="color:#F97583">    IF</span><span style="color:#E1E4E8"> user </span><span style="color:#F97583">!=</span><span style="color:#F97583"> NONE</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">        RETURN</span><span style="color:#9ECBFF"> 'user'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    } </span><span style="color:#F97583">ELSE</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">        RETURN</span><span style="color:#9ECBFF"> 'organization'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<h3 id="testing">Testing</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#6A737D">-- Creating a repository with just a user owner</span></span>
<span class="line"><span style="color:#F97583">CREATE</span><span style="color:#E1E4E8"> repository </span><span style="color:#F97583">SET</span></span>
<span class="line"><span style="color:#F97583">    name</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> 'my_repo'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    user </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> user:abdo;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">-- Creating a repository with just an organization owner</span></span>
<span class="line"><span style="color:#F97583">CREATE</span><span style="color:#E1E4E8"> repository </span><span style="color:#F97583">SET</span></span>
<span class="line"><span style="color:#F97583">    name</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> 'my_repo'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    organization </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> organization:abdo;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">-- ERROR: Fails because BOTH user and organization are set.</span></span>
<span class="line"><span style="color:#F97583">CREATE</span><span style="color:#E1E4E8"> repository </span><span style="color:#F97583">SET</span></span>
<span class="line"><span style="color:#F97583">    name</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> 'hamadas_repo'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    user </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> user:hamada,</span></span>
<span class="line"><span style="color:#E1E4E8">    organization </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> organization:hamada_org;</span></span>
<span class="line"><span style="color:#6A737D">-- Throws: 'An error occurred: a repository cannot have both a user and an organization owner'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">-- ERROR: Fails because NEITHER user nor organization is set.</span></span>
<span class="line"><span style="color:#F97583">CREATE</span><span style="color:#E1E4E8"> repository </span><span style="color:#F97583">SET</span></span>
<span class="line"><span style="color:#F97583">    name</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> 'hamada_repo'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#6A737D">-- Throws: 'An error occurred: a repository requires either a user or an organization owner'</span></span></code></pre>
<p>you can play around with it more by copying and pasting the code into
<a href="https://app.surrealdb.com/c/sandbox/query">Surrealist</a>.</p>
<h2 id="surrealdb-cleaner-solution">SurrealDB Cleaner Solution</h2>
<p>A more cleaner way approach was suggested by <code>jimpex</code> on <a href="https://discord.com/channels/902568124350599239/970338835990974484/1406455766952444038">surrealdb discord</a>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#E1E4E8">DEFINE FIELD </span><span style="color:#F97583">owner</span><span style="color:#F97583"> ON</span><span style="color:#E1E4E8"> repository </span><span style="color:#F97583">TYPE</span><span style="color:#E1E4E8"> record</span><span style="color:#F97583">&#x3C;</span><span style="color:#E1E4E8">user | organization</span><span style="color:#F97583">></span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">DEFINE FIELD owner_type </span><span style="color:#F97583">ON</span><span style="color:#E1E4E8"> repository </span><span style="color:#F97583">VALUE</span><span style="color:#E1E4E8"> meta::tb(</span><span style="color:#F97583">owner</span><span style="color:#E1E4E8">); </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">CREATE</span><span style="color:#E1E4E8"> ONLY repository </span><span style="color:#F97583">SET</span><span style="color:#F97583"> owner</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> user:andy;</span></span>
<span class="line"><span style="color:#F97583">CREATE</span><span style="color:#E1E4E8"> ONLY repository </span><span style="color:#F97583">SET</span><span style="color:#F97583"> owner</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> organization:dunder_mifflin;</span></span>
<span class="line"><span style="color:#F97583">CREATE</span><span style="color:#E1E4E8"> ONLY repository </span><span style="color:#F97583">SET</span><span style="color:#F97583"> owner</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> fail:test;</span></span></code></pre>
<p><img alt="jimpex from surrealdb discord cleaner solution" width="1184" height="437" loading="lazy" decoding="async" src="/_astro/image-surrealdb-jimpex.B9o1DY14_ZIsViI.webp" ></p>
<h2 id="sql">SQL</h2>
<p>For those coming from a relational background, this same logic is typically
handled using a <code>CHECK</code> constraint in the table definition.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#F97583">CREATE</span><span style="color:#F97583"> TABLE</span><span style="color:#B392F0"> users</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    id </span><span style="color:#F97583">INT</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    name</span><span style="color:#F97583"> VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span></span>
<span class="line"><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">CREATE</span><span style="color:#F97583"> TABLE</span><span style="color:#B392F0"> organizations</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    id </span><span style="color:#F97583">INT</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    name</span><span style="color:#F97583"> VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span></span>
<span class="line"><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">CREATE</span><span style="color:#F97583"> TABLE</span><span style="color:#B392F0"> repository</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    id </span><span style="color:#F97583">INT</span><span style="color:#F97583"> PRIMARY KEY</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    name</span><span style="color:#F97583"> VARCHAR</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">NOT NULL</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">    user_id </span><span style="color:#F97583">INT</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    organization_id </span><span style="color:#F97583">INT</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    FOREIGN KEY</span><span style="color:#E1E4E8"> (user_id) </span><span style="color:#F97583">REFERENCES</span><span style="color:#E1E4E8"> users(id),</span></span>
<span class="line"><span style="color:#F97583">    FOREIGN KEY</span><span style="color:#E1E4E8"> (organization_id) </span><span style="color:#F97583">REFERENCES</span><span style="color:#E1E4E8"> organizations(id),</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    CONSTRAINT</span><span style="color:#E1E4E8"> owner_xor_check </span><span style="color:#F97583">CHECK</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">        (user_id </span><span style="color:#F97583">IS NOT NULL</span><span style="color:#F97583"> AND</span><span style="color:#E1E4E8"> organization_id </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        OR</span></span>
<span class="line"><span style="color:#E1E4E8">        (user_id </span><span style="color:#F97583">IS</span><span style="color:#F97583"> NULL</span><span style="color:#F97583"> AND</span><span style="color:#E1E4E8"> organization_id </span><span style="color:#F97583">IS NOT NULL</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    )</span></span>
<span class="line"><span style="color:#E1E4E8">);</span></span></code></pre>
<p>This approach moves validation logic out of your application and into the schema
itself, so the database becomes the single source of truth.</p>
<p>I hope this helps you understand arc relationships and how to enforce XOR fields
in SurrealDB. If you want to learn more about SurrealDB, you can check out the official
documentation <a href="https://surrealdb.com/docs/surrealdb">here</a>.</p>  </div> </div> </article> </main> <footer class="footer footer-center bg-base-200 text-base-content p-10 mt-16"> <aside class="grid-flow-col items-center"> <p class="text-sm">
&copy; 2025 abdo. All rights reserved.
</p> </aside> <nav class="grid-flow-col gap-4"> <a href="https://github.com/abd0-omar" target="_blank" class="btn btn-ghost btn-square" aria-label="Go to talga's GitHub repo"> <svg viewBox="0 0 16 16" aria-hidden="true" class="w-6 h-6 fill-current"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg> </a> <a href="https://www.linkedin.com/in/abdelrahman-omar-739126248/" target="_blank" class="btn btn-ghost btn-square" aria-label="Go to Abdelrahman's LinkedIn profile"> <svg viewBox="0 0 24 24" aria-hidden="true" class="w-6 h-6 fill-current"> <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path> </svg> </a> <a href="mailto:abdelrahman.omar.elgendy@gmail.com" class="btn btn-ghost btn-square" aria-label="Send email to Abdelrahman"> <svg viewBox="0 0 24 24" aria-hidden="true" class="w-6 h-6 fill-current"> <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path> </svg> </a> </nav> </footer> </body></html>